<html>

<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" />
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

<script>   
$(document).ready(function() {
		$('#formselect').hide(); 
        var items=" ---- Choose a user ---- ";
      	$.getJSON("getempnames.php",function(data){
        $.each(data,function(index,item) 
        {
          items+="<option>"+item.EmpName+"</option>";
        });
        $("#customer").html(items); 
      });
            
});

</script>

<script>
function getval(){
    var myobj = {};
    myobj.usrname= $( "#customer option:selected" ).text();
    myobj.usrpass= $("#psw").val();
    
    var myjson = JSON.stringify(myobj);
    
    $.ajax({
  	method: "POST",
  	url: "checkpass.php",
  	data: {"points": myjson}
    })
  	.done(function( msg ) {
    	if(msg == 'Success') {
    	
    	// now set the session storage variables for this user for future actions
    	// get json object of all the data related to the user except the password
    	$.ajaxSetup( { "async": false } );
    	$.getJSON("sessionstore.php", {id: $( "#customer option:selected" ).text()}, function(data){
        $.each(data,function(index,item) 
        {
          localStorage.setItem('username', item.EmpName);
          localStorage.setItem('usermail', item.EmpMail);
          localStorage.setItem('repsupervisor', item.RepSupervisor);
          localStorage.setItem('supmail', item.SupMail);
          localStorage.setItem('issup', item.IsSupervisor); });    
    	});       $.ajaxSetup( { "async": true } ); } else
    	{
    	    $("#psw").val('');
    	    alert('incorrect password');
    	}
  	});
  return false;  
}
</script>

</head>

<body>
<div id="content">
<div>
<select name="customer" id="customer">
    <option> ---- Choose a user ----</option>
</select>
</div>


<p><input type="password" name="psw" id="psw"><p>
<p><input type="button" value="Submit" id="Submit" onclick="getval()"></p>

</div>



<div id='formselect'>

<p> this is the user form link</p>

</div>
</body>

</html>
